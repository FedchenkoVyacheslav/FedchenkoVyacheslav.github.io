"use strict";function d(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s,a=!0,i=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return a=e.done,e},e:function(e){i=!0,s=e},f:function(){try{a||null==o.return||o.return()}finally{if(i)throw s}}}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var c=document.querySelector(".modal_message-js"),t=document.querySelector(".footer__button_message-js"),e=document.querySelector(".modal__close_message-js"),n=document.querySelector(".form__input_message-js");t.addEventListener("click",function(){c.classList.remove("modal_close"),n.focus()}),e.addEventListener("click",function(){c.classList.add("modal_close"),t.focus()}),window.addEventListener("keydown",function(e){c.classList.contains("modal_close")||"Escape"!==e.code||(c.classList.add("modal_close"),t.focus())});var l=document.querySelector(".modal_register-js"),s=document.querySelector(".header__register-button_js"),a=document.querySelector(".mobile-header__register-button_js"),o=document.querySelector(".modal__close_register-js"),i=document.querySelector(".form__input_register-js");a.addEventListener("click",function(){l.classList.remove("modal_close"),i.focus()}),s.addEventListener("click",function(){l.classList.remove("modal_close"),i.focus()}),o.addEventListener("click",function(){l.classList.add("modal_close"),s.focus()}),window.addEventListener("keydown",function(e){l.classList.contains("modal_close")||"Escape"!==e.code||(l.classList.add("modal_close"),s.focus())});var m=document.querySelector(".modal_sing-in-js"),f=document.querySelector(".header__sing-in-button_js"),v=document.querySelector(".mobile-header__sing-in-button_js"),h=document.querySelector(".modal__close_sing-in-js"),g=document.querySelector(".form__input_sing-in-js");v.addEventListener("click",function(){m.classList.remove("modal_close"),g.focus()}),f.addEventListener("click",function(){m.classList.remove("modal_close"),g.focus()}),h.addEventListener("click",function(){m.classList.add("modal_close"),f.focus()}),window.addEventListener("keydown",function(e){m.classList.contains("modal_close")||"Escape"!==e.code||(m.classList.add("modal_close"),f.focus())});var b,p=document.querySelector(".header__mobile-menu_js"),_=document.querySelector(".mobile-header__button-close_js"),y=document.querySelector(".mobile-header");function L(e){for(var t={},n=e.querySelectorAll("input"),o=e.querySelectorAll("textarea"),s=n.length,a=0;a<s;a++){var i=n[a];switch(i.type){case"checkbox":i.checked?t[i.name]="yes":t[i.name]=i.value;break;default:t[i.name]=i.value}}s=o.length;for(var r=0;r<s;r++){var c=o[r];t[c.name]=c.value}return t}function S(n){n.classList.add("form__input_bad"),n.addEventListener("input",function e(t){n.classList.remove("form__input_bad"),n.removeEventListener("input",e)})}function w(n){n.classList.add("form__input_good"),n.addEventListener("input",function e(t){n.classList.remove("form__input_good"),n.removeEventListener("input",e)})}function k(e,t){for(var n=e.querySelectorAll("input"),o=e.querySelectorAll("textarea"),s=e.querySelector(".form__checkbox-indicator"),a=n.length,i=0;i<a;i++){var r=n[i];switch(r.type){case"checkbox":t[r.name]&&s.classList.add("form__checkbox-indicator_bad");break;default:t[r.name]&&(S(r),E(r,t[r.name]))}}a=o.length;for(var c=0;c<a;c++){var l=o[c];t[l.name]&&(S(l),E(l,t[l.name]))}}function q(e){for(var t=e.querySelectorAll("input"),n=e.querySelectorAll("textarea"),o=(e.querySelector(".form__checkbox-indicator"),t.length),s=0;s<o;s++){var a=t[s];w(a),j(a)}o=n.length;for(var i=0;i<o;i++){var r=n[i];w(r),j(r)}}function T(e){return e.match(/^[0-9a-z-\.]+\@[0-9a-z-]{2,}\.[a-z]{2,}$/i)}function E(n,e){var o=document.createElement("div");o.classList.add("invalid-feedback"),o.innerText=e,null==n.nextElementSibling&&(n.insertAdjacentElement("afterend",o),n.addEventListener("input",function e(t){o.remove(),n.removeEventListener("input",e)}))}function j(n){var o=document.createElement("div");o.classList.add("valid-feedback"),o.innerText="All right",null==n.nextElementSibling&&(n.insertAdjacentElement("afterend",o),n.addEventListener("input",function e(t){o.remove(),n.removeEventListener("input",e)}))}p.addEventListener("click",function(){y.classList.add("mobile-header_open")}),_.addEventListener("click",function(){y.classList.remove("mobile-header_open")}),b=document.querySelector(".top-button"),window.addEventListener("scroll",function(){var e=window.pageYOffset;1500<e&&b.classList.add("top-button_show"),e<1500&&b.classList.remove("top-button_show")}),b.addEventListener("click",function e(){var t=window.pageYOffset/50;0<window.pageYOffset&&(window.scrollBy(0,-t),setTimeout(e,0))});var M="https://academy.directlinedev.com";function x(e){var t=e.url,n=e.method,o=void 0===n?"GET":n,s=e.body,a=void 0===s?{}:s,i=e.headers,r={method:o,body:a,headers:void 0===i?{}:i};return"GET"===o&&(r.body=void 0),fetch(M+t,r)}var O=document.querySelector(".header__profile_js"),A=document.querySelector(".mobile-header__profile_js");localStorage.getItem("token")?(f.classList.add("hidden-block"),v.classList.add("hidden"),s.classList.add("hidden-block"),a.classList.add("hidden"),O.classList.remove("hidden-block"),A.classList.remove("hidden")):("/pages/profile/index.html"===window.location.pathname&&(window.location.pathname="/index.html"),f.classList.remove("hidden-block"),v.classList.remove("hidden"),s.classList.remove("hidden-block"),a.classList.remove("hidden"),O.classList.add("hidden-block"),A.classList.add("hidden"));var H=document.querySelector(".button_modal-register"),I=document.querySelector(".button_modal-sing-in"),P=document.querySelector(".button_modal-message");var R=document.querySelector(".loader-container_js");function N(){return'\n  <div class="container-loader">\n    <div class="load-3">\n      <div class="line"></div>\n      <div class="line"></div>\n      <div class="line"></div>\n    </div>\n  </div>\n  '}document.forms["form-register"].addEventListener("submit",function(e){e.preventDefault();var n=e.target,t=L(n),o=n.querySelector(".name-js"),s=n.querySelector(".surname-js"),a=n.querySelector(".location-js"),i=n.querySelector(".age-js"),r={};return null===t.email||""===t.email?(r.email="This field is required",void k(n,r)):T(t.email)?null===t.name||""===t.name?(r.name="This field is required",void k(n,r)):parseInt(o.value)?(r.name="This name is not valid",void k(n,r)):t.name.length<3||20<=t.name.length?(r.name="Your name is too short or too long",void k(n,r)):null===t.surname||""===t.surname?(r.surname="This field is required",void k(n,r)):parseInt(s.value)?(r.surname="This surname is not valid",void k(n,r)):t.surname.length<3||20<=t.surname.length?(r.surname="Your surname is too short or too long",void k(n,r)):null===t.password||""===t.password?(r.password="This field is required",void k(n,r)):t.password.length<3||20<=t.password.length?(r.password="Password must be between 3 and 20 characters",void k(n,r)):null===t.passwordRep||""===t.passwordRep?(r.passwordRep="This field is required",void k(n,r)):t.password!==t.passwordRep?(r.passwordRep="Password mismatch",void k(n,r)):null===t.location||""===t.location?(r.location="This field is required",void k(n,r)):parseInt(a.value)?(r.location="This location is not valid",void k(n,r)):t.location.length<3||20<=t.location.length?(r.location="Location name is too short or too long",void k(n,r)):i.value<18||100<=i.value?(r.age="This age is not valid",void k(n,r)):null===t.age||""===t.age?(r.age="This field is required",void k(n,r)):"no"===t.acceptbutton?(r.acceptbutton="You didn't agree to processing of your personal data",void k(n,r)):(R.innerHTML=N(),void x({url:"/api/users",method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json;charset=utf-8"}}).then(function(e){return e.json()}).then(function(e){if(!e.success)throw e.errors;var t=e.data;R.innerHTML="",q(n),H.classList.remove("button_bad"),H.classList.add("button_good"),alert("User ".concat(t.name," ").concat(t.surname," successfully registered")),setTimeout(function(){l.classList.add("modal_close")},2e3)}).catch(function(e){R.innerHTML="",k(n,e),H.classList.remove("button_good"),H.classList.add("button_bad"),alert("".concat(JSON.stringify(e,null,2)))})):(r.email='Please enter a valid email address (your entry is not in the format "somebody@example.com")',void k(n,r))}),document.forms["form-sing-in"].addEventListener("submit",function(e){e.preventDefault();var o=e.target,t=L(o),n={};return null===t.email||""===t.email?(n.email="This field is required",void k(o,n)):T(t.email)?null===t.password||""===t.password?(n.password="This field is required",void k(o,n)):(R.innerHTML=N(),void x({url:"/api/users/login",method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json;charset=utf-8"}}).then(function(e){return e.json()}).then(function(e){if(!e.success)throw alert("ERROR! This combination, mail and password were not found!");var t,n=e.data;R.innerHTML="",q(o),I.classList.add("button_good"),alert("User with Id ".concat(n.userId," authenticated successfully")),setTimeout(function(){m.classList.add("modal_close"),y.classList.remove("mobile-header_open")},2e3),localStorage.setItem("userId",n.userId),(t=n.token)?(localStorage.setItem("token",t),f.classList.add("hidden-block"),v.classList.add("hidden"),s.classList.add("hidden-block"),a.classList.add("hidden"),O.classList.remove("hidden-block"),A.classList.remove("hidden")):(localStorage.removeItem("token"),f.classList.remove("hidden-block"),v.classList.remove("hidden"),s.classList.remove("hidden-block"),a.classList.remove("hidden"),O.classList.add("hidden-block"),A.classList.add("hidden")),checkToken()}).catch(function(e){R.innerHTML="",I.classList.add("button_bad"),k(o,e)})):(n.email='Please enter a valid email address (your entry is not in the format "somebody@example.com")',void k(o,n))}),document.forms["form-message"].addEventListener("submit",function(e){e.preventDefault();var t=e.target,n=L(t),o=t.querySelector(".name-js"),s=t.querySelector(".message-js"),a=(t.querySelector(".form__input email-js"),{}),i={};return i.to=n.email,i.body=JSON.stringify(n),null===n.name||""===n.name?(a.name="This field is required",void k(t,a)):parseInt(o.value)?(a.name="This name is not valid",void k(t,a)):n.name.length<3||20<=n.name.length?(a.name="Your name is too short or too long",void k(t,a)):null===n.message||""===n.message?(a.message="This field is required",void k(t,a)):parseInt(s.value)?(a.message="This message is not valid",void k(t,a)):n.message.length<3||20<=n.message.length?(a.message="Your message is too short or too long",void k(t,a)):null===n.email||""===n.email?(a.email="This field is required",void k(t,a)):T(n.email)?null===n.phone||""===n.phone?(a.phone="This field is required",void k(t,a)):n.phone.match(/^(\s*)?(\+)?([-_():=+]?\d[- _():=+]?){10,14}(\s*)?$/)?null===n.messagetext||""===n.messagetext?(a.messagetext="This field is required",void k(t,a)):n.messagetext.length<3?(a.messagetext="Your message is too short",void k(t,a)):"no"===n.acceptbutton?(a.acceptbutton="You didn't agree to processing of your personal data",void k(t,a)):(R.innerHTML=N(),void x({url:"/api/emails",method:"POST",body:JSON.stringify(i),headers:{"Content-Type":"application/json;charset=utf-8"}}).then(function(e){return e.json()}).then(function(e){if(!e.success)throw alert("This mail is already subscribed to the newsletter");R.innerHTML="",alert("User successfully subscribed to email newsletter"),q(t),P.classList.remove("button_bad"),P.classList.add("button_good"),setTimeout(function(){c.classList.add("modal_close")},2e3)}).catch(function(e){R.innerHTML="",P.classList.remove("button_good"),P.classList.add("button_bad")})):(a.phone="Please enter a valid phone number",void k(t,a)):(a.email='Please enter a valid email address (your entry is not in the format "somebody@example.com")',void k(t,a))}),function(){var r=document.querySelector(".filter__tag"),_=document.querySelector(".blog"),y=l(),t=document.querySelector(".selector-btn_back"),n=document.querySelector(".selector-btn_forward");function L(){return'\n    <div class="load-3">\n      <div class="line"></div>\n      <div class="line"></div>\n      <div class="line"></div>\n    </div>\n    '}function S(e){return'\n    <li class="blog__item">\n            <picture class="blog__img-box">\n              <source srcset="'.concat(M).concat(e.mobilePhotoUrl,", ").concat(M).concat(e.mobile2xPhotoUrl,'" media="(max-width: 700px)">\n              <source srcset="').concat(M).concat(e.tabletPhotoUrl,", ").concat(M).concat(e.tablet2xPhotoUrl,'" media="(max-width: 850px)">\n              <source srcset="').concat(M).concat(e.desktopPhotoUrl,", ").concat(M).concat(e.desktop2xPhotoUrl,'">\n              <img class="blog__img" src="').concat(M).concat(e.desktopPhotoUrl,'" width="320" height="236" alt="').concat(e.title,'"/>\n            </picture>\n            <div class="blog__content">\n              <ul class="blog__tag-list list-point-none">\n                ').concat(function(e){for(var t="",n=0;n<e.length;n++){var o=e[n];t+=function(e){return'\n      <li aria-label="tag '.concat(e.tagId,'" class="blog__tag blog__tag_').concat(e.tagId,'"></li>\n    ')}(o)}return t}(e.tags),'\n              </ul>\n              <span class="blog__date blog__info">').concat(function(e){var t=new Date(e),n=t.getFullYear(),o=1+t.getMonth();o<10&&(o="0"+o);var s=t.getDate();s<10&&(s="0"+s);return s+"."+o+"."+n}(e.date),'</span>\n              <span class="blog__views blog__info">').concat(e.views,' views</span>\n              <span class="blog__comments blog__info">').concat(e.commentsCount,' comments</span>\n              <h2 class="blog__title">').concat(e.title,'</h2>\n              <p class="blog__text">').concat(e.text,'</p>\n              <a class="blog__link" href="#">Go to this post</a>\n            </div>\n          </li>\n    ')}function w(e){for(var a=e.page?+e.page:1,i=e.howShow?+e.howShow:5,t=(a-1)*i,n=JSON.stringify(e.tags||[]),o=e.commentsCount||[],s=51,r=-1,c=0;c<o.length;c++)var l=o[c].split("-")[0],d=o[c].split("-")[1],s=+q(+s,q(+l,+d)),r=+k(+r,k(+l,+d));var u={},m="";51!==s&&-1!==r&&(u.commentsCount={$between:[s,r]}),Object.keys(u)&&(m="&filter="+JSON.stringify(u));var f=e.views||"",v=f.split("-")[0],h=f.split("-")[1];u.views={$between:[v,h]},Object.keys(u)&&(m="&filter="+JSON.stringify(u));var g="",b=[e.sortBy,"ASC"];Object.keys(b)&&(g="&sort="+JSON.stringify(b));var p=e.search;""!==p&&(u.title=p),Object.keys(u)&&(m="&filter="+JSON.stringify(u)),T("GET","/api/posts?limit=".concat(i,"&offset=").concat(t,"&tags=").concat(n).concat(m).concat(g),function(e){var t=JSON.parse(e.response);if(t.success){for(var n=t.data,o="",s=0;s<n.length;s++)o+=S(n[s]);_.innerHTML=o,function(t,o){var s=document.querySelector(".selector-pages");s.innerHTML="";for(var e=0;e<t;e++)!function(n){var e=document.createElement("a");e.classList.add("selector-link"),e.setAttribute("href","#"),e.setAttribute("aria-label","Page "+(n+1)),O=o,A=Math.ceil(t),o===n+1&&e.classList.add("selector-link_active"),e.innerHTML=n+1,e.addEventListener("click",function(e){e.preventDefault();var t=E(x);t.page=n+1+"",j(t),w(y=t)}),s.insertAdjacentElement("beforeend",e)}(e)}(t.count/i,a)}else alert("ERROR!");""===_.innerHTML&&(_.innerHTML='\n    <p class="blog__message">Nothing found</p>\n    ')},function(){_.innerHTML=L()})}function k(e,t){return t<e?e:t}function q(e,t){return t<e?t:e}function T(e,t,n,o,s){o&&o();var a=new XMLHttpRequest;a.open(e,M+t),a.send(),a.onload=function(){n(a)},a.onerror=function(){s&&s(a)}}function E(e){var t,n={},o=e.querySelectorAll("input"),s=(o.length,d(o));try{for(s.s();!(t=s.n()).done;){var a=t.value;switch(a.type){case"radio":a.checked&&(n[a.name]=a.value);break;case"checkbox":n[a.name]||(n[a.name]=[]),a.checked&&n[a.name].push(a.value);break;default:n[a.name]=a.value}}}catch(e){s.e(e)}finally{s.f()}return n}function c(e,t){var n,o=e.querySelectorAll("input"),s=(o.length,d(o));try{for(s.s();!(n=s.n()).done;){var a=n.value;switch(a.type){case"radio":t[a.name]&&t[a.name]===a.value&&(a.checked=!0);break;case"checkbox":if(t[a.name])if("object"===u(t[a.name]))for(var i=0;i<t[a.name].length;i++)t[a.name][i]===a.value&&(a.checked=!0);else t[a.name]===a.value&&(a.checked=!0);break;default:t[a.name]&&(a.value=t[a.name])}}}catch(e){s.e(e)}finally{s.f()}}function l(){var e={};if(location.search)for(var t=location.search.substring(1).split("&"),n=0;n<t.length;n++){var o=t[n].split("="),s=o[0],a=o[1].replace(/%20/g," ");e[s]?"string"==typeof e[s]?e[s]=[e[s],a]:e[s].push(a):e[s]=a}return e}function j(e){for(var t=[],n=Object.keys(e),o=0;o<n.length;o++)if("string"==typeof e[n[o]])t.push(n[o]+"="+e[n[o]]);else for(var s=0;s<e[n[o]].length;s++)t.push(n[o]+"="+e[n[o]][s]);window.history.replaceState({},document.title,"?"+t.join("&"))}T("GET","/api/tags",function(e){var t,n,o=JSON.parse(e.response);if(o.success){for(var s=o.data,a="",i=0;i<s.length;i++)a+=(n=s[i],'\n    <label class="filter__checkbox-label">\n      <input aria-label="tag '.concat(n.id,'" class="filter__form-checkbox hidden" type="checkbox" value="').concat(n.id,'" name="tags">\n      <span class="filter__form-checkbox-indicator filter__form-checkbox-indicator_2 filter__form-checkbox-indicator_tag-').concat(n.id,'"></span>\n    </label>\n    '));r.innerHTML=a,c(x,l()),(t=E(x)).tags=[1,6],j(t),w(y=t),c(x,l()),j(E(x)),w(E(x))}else alert("ERROR!")},function(){r.innerHTML=L()}),"object"!==u(y.tags)&&(y.tags=[y.tags]),w(y);var x=document.forms.filterForm;c(x,l()),x.addEventListener("submit",function(e){e.preventDefault();var t=E(e.target);j(t),y.page="1",w(y=t)});var O=0,A=0;function o(e){0<O-e&&n.removeAttribute("disabled"),O-e<0&&t.removeAttribute("disabled"),0===e&&t.setAttribute("disabled","disabled"),e===A&&n.setAttribute("disabled","disabled"),O=e}n.addEventListener("click",function(){var e=O+1;o(e);var t=E(x);t.page=e+"",j(t),w(y=t)}),t.addEventListener("click",function(){var e,t=O-1;o(t),0<O&&((e=E(x)).page=t+"",j(e),w(y=e))})}();