"use strict";var d=document.querySelector(".modal_message-js"),t=document.querySelector(".footer__button_message-js"),e=document.querySelector(".modal__close_message-js"),o=document.querySelector(".form__input_message-js");t.addEventListener("click",function(){d.classList.remove("modal_close"),o.focus()}),e.addEventListener("click",function(){d.classList.add("modal_close"),t.focus()}),window.addEventListener("keydown",function(e){d.classList.contains("modal_close")||"Escape"!==e.code||(d.classList.add("modal_close"),t.focus())});var r=document.querySelector(".modal_register-js"),i=document.querySelector(".header__register-button_js"),a=document.querySelector(".mobile-header__register-button_js"),s=document.querySelector(".modal__close_register-js"),n=document.querySelector(".form__input_register-js");a.addEventListener("click",function(){r.classList.remove("modal_close"),n.focus()}),i.addEventListener("click",function(){r.classList.remove("modal_close"),n.focus()}),s.addEventListener("click",function(){r.classList.add("modal_close"),i.focus()}),window.addEventListener("keydown",function(e){r.classList.contains("modal_close")||"Escape"!==e.code||(r.classList.add("modal_close"),i.focus())});var l=document.querySelector(".modal_sing-in-js"),c=document.querySelector(".header__sing-in-button_js"),u=document.querySelector(".mobile-header__sing-in-button_js"),m=document.querySelector(".modal__close_sing-in-js"),v=document.querySelector(".form__input_sing-in-js");u.addEventListener("click",function(){l.classList.remove("modal_close"),v.focus()}),c.addEventListener("click",function(){l.classList.remove("modal_close"),v.focus()}),m.addEventListener("click",function(){l.classList.add("modal_close"),c.focus()}),window.addEventListener("keydown",function(e){l.classList.contains("modal_close")||"Escape"!==e.code||(l.classList.add("modal_close"),c.focus())});var h,f=document.querySelector(".header__mobile-menu_js"),_=document.querySelector(".mobile-header__button-close_js"),p=document.querySelector(".mobile-header");function g(e){for(var t={},o=e.querySelectorAll("input"),s=e.querySelectorAll("textarea"),n=o.length,i=0;i<n;i++){var a=o[i];switch(a.type){case"checkbox":a.checked?t[a.name]="yes":t[a.name]=a.value;break;default:t[a.name]=a.value}}n=s.length;for(var d=0;d<n;d++){var r=s[d];t[r.name]=r.value}return t}function L(o){o.classList.add("form__input_bad"),o.addEventListener("input",function e(t){o.classList.remove("form__input_bad"),o.removeEventListener("input",e)})}function b(o){o.classList.add("form__input_good"),o.addEventListener("input",function e(t){o.classList.remove("form__input_good"),o.removeEventListener("input",e)})}function y(e,t){for(var o=e.querySelectorAll("input"),s=e.querySelectorAll("textarea"),n=e.querySelector(".form__checkbox-indicator"),i=o.length,a=0;a<i;a++){var d=o[a];switch(d.type){case"checkbox":t[d.name]&&n.classList.add("form__checkbox-indicator_bad");break;default:t[d.name]&&(L(d),q(d,t[d.name]))}}i=s.length;for(var r=0;r<i;r++){var l=s[r];t[l.name]&&(L(l),q(l,t[l.name]))}}function S(e){for(var t=e.querySelectorAll("input"),o=e.querySelectorAll("textarea"),s=(e.querySelector(".form__checkbox-indicator"),t.length),n=0;n<s;n++){var i=t[n];b(i),T(i)}s=o.length;for(var a=0;a<s;a++){var d=o[a];b(d),T(d)}}function w(e){return e.match(/^[0-9a-z-\.]+\@[0-9a-z-]{2,}\.[a-z]{2,}$/i)}function q(o,e){var s=document.createElement("div");s.classList.add("invalid-feedback"),s.innerText=e,null==o.nextElementSibling&&(o.insertAdjacentElement("afterend",s),o.addEventListener("input",function e(t){s.remove(),o.removeEventListener("input",e)}))}function T(o){var s=document.createElement("div");s.classList.add("valid-feedback"),s.innerText="All right",null==o.nextElementSibling&&(o.insertAdjacentElement("afterend",s),o.addEventListener("input",function e(t){s.remove(),o.removeEventListener("input",e)}))}f.addEventListener("click",function(){p.classList.add("mobile-header_open")}),_.addEventListener("click",function(){p.classList.remove("mobile-header_open")}),h=document.querySelector(".top-button"),window.addEventListener("scroll",function(){var e=window.pageYOffset;1500<e&&h.classList.add("top-button_show"),e<1500&&h.classList.remove("top-button_show")}),h.addEventListener("click",function e(){var t=window.pageYOffset/50;0<window.pageYOffset&&(window.scrollBy(0,-t),setTimeout(e,0))});function k(e){var t=e.url,o=e.method,s=void 0===o?"GET":o,n=e.body,i=void 0===n?{}:n,a=e.headers,d={method:s,body:i,headers:void 0===a?{}:a};return"GET"===s&&(d.body=void 0),fetch("https://academy.directlinedev.com"+t,d)}var E=document.querySelector(".header__profile_js"),j=document.querySelector(".mobile-header__profile_js");localStorage.getItem("token")?(c.classList.add("hidden-block"),u.classList.add("hidden"),i.classList.add("hidden-block"),a.classList.add("hidden"),E.classList.remove("hidden-block"),j.classList.remove("hidden")):("/pages/profile/index.html"===window.location.pathname&&(window.location.pathname="/index.html"),c.classList.remove("hidden-block"),u.classList.remove("hidden"),i.classList.remove("hidden-block"),a.classList.remove("hidden"),E.classList.add("hidden-block"),j.classList.add("hidden"));var x=document.querySelector(".button_modal-register"),A=document.querySelector(".button_modal-sing-in"),I=document.querySelector(".button_modal-message");var H=document.querySelector(".loader-container_js");function O(){return'\n  <div class="loader-wrapper">\n    <div class="loader">\n      <div class="loader-line"></div>\n      <div class="loader-line"></div>\n      <div class="loader-line"></div>\n    </div>\n  </div>\n  '}document.forms["form-register"].addEventListener("submit",function(e){e.preventDefault();var t=e.target,o=g(t),s=t.querySelector(".name-js"),n=t.querySelector(".surname-js"),i=t.querySelector(".location-js"),a=t.querySelector(".age-js"),d={};return null===o.email||""===o.email?(d.email="This field is required",void y(t,d)):w(o.email)?null===o.name||""===o.name?(d.name="This field is required",void y(t,d)):parseInt(s.value)?(d.name="This name is not valid",void y(t,d)):o.name.length<3||20<=o.name.length?(d.name="Your name is too short or too long",void y(t,d)):null===o.surname||""===o.surname?(d.surname="This field is required",void y(t,d)):parseInt(n.value)?(d.surname="This surname is not valid",void y(t,d)):o.surname.length<3||20<=o.surname.length?(d.surname="Your surname is too short or too long",void y(t,d)):null===o.password||""===o.password?(d.password="This field is required",void y(t,d)):o.password.length<3||20<=o.password.length?(d.password="Password must be between 3 and 20 characters",void y(t,d)):null===o.passwordRep||""===o.passwordRep?(d.passwordRep="This field is required",void y(t,d)):o.password!==o.passwordRep?(d.passwordRep="Password mismatch",void y(t,d)):null===o.location||""===o.location?(d.location="This field is required",void y(t,d)):parseInt(i.value)?(d.location="This location is not valid",void y(t,d)):o.location.length<3||20<=o.location.length?(d.location="Location name is too short or too long",void y(t,d)):a.value<18||100<=a.value?(d.age="This age is not valid",void y(t,d)):null===o.age||""===o.age?(d.age="This field is required",void y(t,d)):"no"===o.acceptbutton?(d.acceptbutton="You didn't agree to processing of your personal data",void y(t,d)):(H.innerHTML=O(),void k({url:"/api/users",method:"POST",body:JSON.stringify(o),headers:{"Content-Type":"application/json;charset=utf-8"}}).then(function(e){return e.json()}).then(function(e){if(!e.success)throw e.errors;H.innerHTML="",S(t),x.classList.remove("button_bad"),x.classList.add("button_good"),setTimeout(function(){r.classList.add("modal_close")},2e3)}).catch(function(e){H.innerHTML="",e.email&&(e.email="This email is already in use"),y(t,e),x.classList.remove("button_good"),x.classList.add("button_bad")})):(d.email='Please enter a valid email address (your entry is not in the format "somebody@example.com")',void y(t,d))}),document.forms["form-sing-in"].addEventListener("submit",function(e){e.preventDefault();var s=e.target,t=g(s),n={};return null===t.email||""===t.email?(n.email="This field is required",void y(s,n)):w(t.email)?null===t.password||""===t.password?(n.password="This field is required",void y(s,n)):(H.innerHTML=O(),void k({url:"/api/users/login",method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json;charset=utf-8"}}).then(function(e){return e.json()}).then(function(e){if(!e.success)throw n;var t,o=e.data;H.innerHTML="",A.classList.add("button_good"),S(s),setTimeout(function(){l.classList.add("modal_close"),p.classList.remove("mobile-header_open")},2e3),localStorage.setItem("userId",o.userId),(t=o.token)?(localStorage.setItem("token",t),c.classList.add("hidden-block"),u.classList.add("hidden"),i.classList.add("hidden-block"),a.classList.add("hidden"),E.classList.remove("hidden-block"),j.classList.remove("hidden")):(localStorage.removeItem("token"),c.classList.remove("hidden-block"),u.classList.remove("hidden"),i.classList.remove("hidden-block"),a.classList.remove("hidden"),E.classList.add("hidden-block"),j.classList.add("hidden")),checkToken()}).catch(function(e){H.innerHTML="",A.classList.add("button_bad"),e.email="This combination, mail and password were not found!",y(s,e)})):(n.email='Please enter a valid email address (your entry is not in the format "somebody@example.com")',void y(s,n))}),document.forms["form-message"].addEventListener("submit",function(e){e.preventDefault();var t=e.target,o=g(t),s=t.querySelector(".name-js"),n=t.querySelector(".message-js"),i=(t.querySelector(".form__input email-js"),{});i.to=o.email,i.body=JSON.stringify(o);var a={};return null===o.name||""===o.name?(a.name="This field is required",void y(t,a)):parseInt(s.value)?(a.name="This name is not valid",void y(t,a)):o.name.length<3||20<=o.name.length?(a.name="Your name is too short or too long",void y(t,a)):null===o.message||""===o.message?(a.message="This field is required",void y(t,a)):parseInt(n.value)?(a.message="This message is not valid",void y(t,a)):o.message.length<3||20<=o.message.length?(a.message="Your message is too short or too long",void y(t,a)):null===o.email||""===o.email?(a.email="This field is required",void y(t,a)):w(o.email)?null===o.phone||""===o.phone?(a.phone="This field is required",void y(t,a)):o.phone.match(/^(\s*)?(\+)?([-_():=+]?\d[- _():=+]?){10,14}(\s*)?$/)?null===o.messagetext||""===o.messagetext?(a.messagetext="This field is required",void y(t,a)):o.messagetext.length<3?(a.messagetext="Your message is too short",void y(t,a)):"no"===o.acceptbutton?(a.acceptbutton="You didn't agree to processing of your personal data",void y(t,a)):(H.innerHTML=O(),void k({url:"/api/emails",method:"POST",body:JSON.stringify(i),headers:{"Content-Type":"application/json;charset=utf-8"}}).then(function(e){return e.json()}).then(function(e){if(!e.success)throw a;H.innerHTML="",S(t),I.classList.remove("button_bad"),I.classList.add("button_good"),setTimeout(function(){d.classList.add("modal_close")},2e3)}).catch(function(e){H.innerHTML="",I.classList.remove("button_good"),I.classList.add("button_bad"),e.email="This mail is already subscribed to the newsletter",y(t,e)})):(a.phone="Please enter a valid phone number",void y(t,a)):(a.email='Please enter a valid email address (your entry is not in the format "somebody@example.com")',void y(t,a))});var P=document.querySelector(".slider__wrapper"),Y=document.querySelector(".slider__inner-wrapper"),M=document.querySelector(".slider__pagination"),C=document.querySelector(".slider__button_back"),R=document.querySelector(".slider__button_next"),z=document.querySelectorAll(".slider__slide"),J=+getComputedStyle(P).width.split("px")[0],N=Y.childElementCount-1,D=0,B=[];function G(){J=+getComputedStyle(P).width.split("px")[0];for(var e=0;e<z.length;e++)z[e].style.width=J+"px"}function $(e){e<0||N<e||(Y.style.transition="margin-left .5s",B[D].classList.remove("slider__dot_active"),B[e].classList.add("slider__dot_active"),0<D-e&&R.removeAttribute("disabled"),D-e<0&&C.removeAttribute("disabled"),0===e&&C.setAttribute("disabled","disabled"),e===N&&R.setAttribute("disabled","disabled"),Y.style.marginLeft="-"+J*e+"px",D=e,localStorage.setItem("activeSlide",D))}G(),function(){for(var e=0;e<z.length;e++)!function(e){var t=document.createElement("button");t.classList.add("slider__dot"),t.setAttribute("aria-label","Pagination dot"),e===D&&t.classList.add("slider__dot_active"),t.addEventListener("click",function(){$(e)}),B[B.length]=t,M.insertAdjacentElement("beforeend",t)}(e)}(),R.addEventListener("click",function(){$(D+1)}),C.addEventListener("click",function(){$(D-1)}),window.addEventListener("resize",function(){Y.style.transition="",G(),$(D),Y.style.transition="margin-left .5s"}),localStorage.getItem("activeSlide")&&$(+localStorage.getItem("activeSlide"));new Swiper(".swiper-container",{autoHeight:!0,spaceBetween:20,loop:!0,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}});